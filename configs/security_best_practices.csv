id,check_id,category,check,evaluation_value,severity,recommendation,aws,azure,gcp,enable,alert,logic,api,aws_doc_url,azure_doc_url,gcp_doc_url
1,DP-1,Data Protection,Secrets Management,1,Medium,Store and use secrets securely,1,0,0,1,0,Check if there are any secrets configured in the workspace by listing scopes and looking for the secrets count against the configured baseline value in those scopes,curl --netrc -X GET \ https://<workspace_url>/api/2.0/secrets/scopes/list,https://docs.databricks.com/security/secrets/index.html,https://docs.databricks.com/security/secrets/index.html,https://docs.databricks.com/security/secrets/index.html
2,DP-2,Data Protection,Cluster Encryption,-1,Medium,All clusters should enable local disk encryption,1,0,0,1,0,Check if enable_local_disk_encryption is set as false for any cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list,https://docs.databricks.com/clusters/configure.html#local-disk-encryption,https://docs.databricks.com/clusters/configure.html#local-disk-encryption,https://docs.databricks.com/clusters/configure.html#local-disk-encryption
3,DP-3,Data Protection,BYOK,-1,Low,Add a customer-managed key for managed services and workspace storage,1,0,0,1,0,Check if storage_customer_managed_key_id value is set for each workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/security/keys/customer-managed-keys-storage-aws.html,https://docs.databricks.com/security/keys/customer-managed-keys-storage-aws.html,https://docs.databricks.com/security/keys/customer-managed-keys-storage-aws.html
4,DP-4,Data Protection,S3 Encryption,-1,High,Encrypt S3 buckets and restrict access,1,0,0,1,0,Manual check,Manual check,https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html,https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html,https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html
5,DP-5,Data Protection,Results Downloading,-1,High,Disable download button for notebook results,1,0,0,1,0,Check workspace-conf for enableResultsDownloading setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableResultsDownloading',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results,https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results,https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results
6,GOV-1,Governance,Cluster Policies,-1,High,Configure cluster policies to enforce data access patterns and control costs,1,0,0,1,0,Check if policy_id is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/administration-guide/clusters/policies.html,https://docs.databricks.com/administration-guide/clusters/policies.html,https://docs.databricks.com/administration-guide/clusters/policies.html
7,GOV-2,Governance,PAT Tokens About to Expire,7,High,"Set lifetime limit, but also regularly review PAT tokens to avoid expired tokens impacting authentications",1,0,0,1,0,Check each token expiry_time and report if the expiry_time is within configured days,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list | jq .,https://docs.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens,https://docs.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens,https://docs.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens
8,GOV-3,Governance,Log delivery configurations,-1,High,Configure Databricks audit log delivery,1,0,0,1,0,"Check account log-delivery configuration and look for audit log config with log_type set as ""AUDIT_LOGS"" and status set as ""ENABLED""",curl -netrc -X GET \ 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/log-delivery',https://docs.databricks.com/administration-guide/account-settings/audit-logs.html#configure-audit-log-delivery,https://docs.databricks.com/administration-guide/account-settings/audit-logs.html#configure-audit-log-delivery,https://docs.databricks.com/administration-guide/account-settings/audit-logs.html#configure-audit-log-delivery
9,GOV-4,Governance,Long running clusters,24,Medium,Automatically restart long running clusters,1,0,0,1,0,Check each running cluster's last restart time till now and report on clusters that were running longer than the configured number of days without a restart,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/clusters-manage.html#restart-a-cluster-to-update-it-with-the-latest-images,https://docs.databricks.com/clusters/clusters-manage.html#restart-a-cluster-to-update-it-with-the-latest-images,https://docs.databricks.com/clusters/clusters-manage.html#restart-a-cluster-to-update-it-with-the-latest-images
10,GOV-5,Governance,Deprecated runtime versions,-1,High,Deprecated runtime version detected. Please update your cluster runtimes to Databricks supported runtimes,1,0,0,1,0,List clusters with spark version that is not in the supported spark versions,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/spark-versions,https://docs.databricks.com/release-notes/runtime/releases.html,https://docs.databricks.com/release-notes/runtime/releases.html,https://docs.databricks.com/release-notes/runtime/releases.html
11,GOV-6,Governance,All Purpose Cluster Custom Tags,-1,Low,Configure cluster tagging to monitor usage and enable charge-back,1,0,0,1,0,check if custom_tags is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html
12,GOV-7,Governance,Job Cluster Custom Tags,-1,Low,Configure job tagging to monitor usage and enable charge-back,1,0,0,1,0,Check if settings.new_cluster.custom_tags is not null for job clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html
13,GOV-8,Governance,All Purpose Cluster Log Configuration,-1,Low,Configure Databricks cluster log delivery,1,0,0,1,0,Check if cluster_log_conf is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1
14,GOV-9,Governance,Job Cluster Log Configuration,-1,Low,Configure Databricks job custer log delivery,1,0,0,1,0,Check if cluster_log_conf is set for job clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1
15,GOV-10,Governance,Managed Tables,5,Low,The DBFS root is not intended for production customer data,1,0,0,1,0,Check the /user/hive/warehouse/ folder for any data folders stored more than the configured value,"curl --netrc -X GET \ https://<workspace_url>/api/2.0/dbfs/list \ --data '{ ""path"": ""/user/hive/warehouse/"" }'",https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations,https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations,https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations
16,GOV-11,Governance,Mounts,1,Low,Avoid FUSE mounts for accessing production data,1,0,0,1,0,Check for mnt paths in dbutils.fs.mounts() and report if there are datasources loaded as FUSE mounts to the workspace than the configured value,dbutils.fs.mounts(),https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations,https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations,https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations
17,GOV-12,Governance,UC enabled clusters,-1,High,Use UC enabled clusters,1,0,0,1,0,Check if there are clusters without data_security_mode as (USER_ISOLATION or SINGLE_USER) or data_security_mode as none,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/data-governance/unity-catalog/index.html#cluster-access-modes-for-unity-catalog,https://docs.databricks.com/data-governance/unity-catalog/index.html#cluster-access-modes-for-unity-catalog,https://docs.databricks.com/data-governance/unity-catalog/index.html#cluster-access-modes-for-unity-catalog
18,IA-1,Identity & Access,SSO,-1,High,Authenticate via single sign-on and leverage multi-factor authentication,1,0,0,1,0,Manual check,Manual check,https://docs.databricks.com/administration-guide/users-groups/single-sign-on/index.html,https://docs.databricks.com/administration-guide/users-groups/single-sign-on/index.html,https://docs.databricks.com/administration-guide/users-groups/single-sign-on/index.html
19,IA-2,Identity & Access,SCIM,-1,High,Keep an up-to-date user list by using SCIM,1,0,0,1,0,Manual check,Manual check,https://docs.databricks.com/administration-guide/users-groups/scim/index.html,https://docs.databricks.com/administration-guide/users-groups/scim/index.html,https://docs.databricks.com/administration-guide/users-groups/scim/index.html
20,IA-3,Identity & Access,Table Access Control,-1,High,Enable Table Access Control in admin settings so that you can utilize Table ACL clusters that enforce user isolation,1,0,0,1,0,Manual check,Manual check,https://docs.databricks.com/administration-guide/access-control/table-acl.html,https://docs.databricks.com/administration-guide/access-control/table-acl.html,https://docs.databricks.com/administration-guide/access-control/table-acl.html
21,IA-4,Identity & Access,PAT Token with no lifetime limit,-1,Medium,Configure maximum token lifetimes for future tokens using token management,1,0,0,1,0,Check each token expiry_time and report if the expiry_time is not within the configured number of days or set to never expire by using -1 as the value,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list,https://docs.databricks.com/administration-guide/access-control/tokens.html,https://docs.databricks.com/administration-guide/access-control/tokens.html,https://docs.databricks.com/administration-guide/access-control/tokens.html
22,INFO-1,Informational,Instance Pool Custom Tag,-1,Low,Configure tagging to monitor usage and enable charge-back,1,0,0,1,0,Check if instance-pools have custom tags configured,curl --netrc -X GET \ https://<workspace_url>/api/2.0/instance-pools/list | jq .,https://docs.databricks.com/clusters/instance-pools/configure.html#pool-tags,https://docs.databricks.com/clusters/instance-pools/configure.html#pool-tags,https://docs.databricks.com/clusters/instance-pools/configure.html#pool-tags
23,INFO-2,Informational,Max concurrent runs,5,Low,Limit the number of parallel runs for a given job to avoid resource contention,1,0,0,1,0,Check if max_concurrent_runs configuration for each job is less than configured value,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/data-engineering/jobs/jobs.html#max-concurrent-runs,https://docs.databricks.com/data-engineering/jobs/jobs.html#max-concurrent-runs,https://docs.databricks.com/data-engineering/jobs/jobs.html#max-concurrent-runs
24,INFO-3,Informational,Global libraries,-1,Low,"Global libraries are discouraged for security reasons. Use cluster libraries or notebook-scoped libraries to improve startup time for clusters that don't require that library, and to improve flexibility where that library is not required.",1,0,0,1,0,Check if is_library_for_all_clusters is set as true for any library that is configured for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/libraries/all-cluster-statuses | jq .,https://docs.databricks.com/libraries/cluster-libraries.html,https://docs.databricks.com/libraries/cluster-libraries.html,https://docs.databricks.com/libraries/cluster-libraries.html
25,INFO-4,Informational,User Privileges,10,Low,Limit number of users with cluster create privileges,1,0,0,1,0,"Check entitlements.value for each user and look if they have 'allow-cluster-create', 'allow-instance-pool-create' as permission, and count the number of users with such permissions to report if that crossed the configured threshold.",curl --netrc -X GET \ https://<workspace_url>/api/2.0/preview/scim/v2/Users,https://docs.databricks.com/security/access-control/cluster-acl.html,https://docs.databricks.com/security/access-control/cluster-acl.html,https://docs.databricks.com/security/access-control/cluster-acl.html
26,INFO-5,Informational,Global Init Script,-1,Medium,"Global init scripts are discouraged for security, improved startup and flexibility reasons",1,0,0,1,0,Check if there are any global-init-scripts configured,curl --netrc -X GET \ https://<workspace_url>/api/2.0/global-init-scripts,https://docs.databricks.com/clusters/init-scripts.html#global-init-scripts,https://docs.databricks.com/clusters/init-scripts.html#global-init-scripts,https://docs.databricks.com/clusters/init-scripts.html#global-init-scripts
27,INFO-6,Informational,Admin Count,5,Low,Limit the number of admin accounts so that most users are not admins,1,0,0,1,0,"Check members count of diplayName ""admins"" in groups to report if the count is more than the configured threshold",curl --netrc -X GET \ https://<workspace_url>/api/2.0/preview/scim/v2/Groups,https://docs.databricks.com/administration-guide/users-groups/users.html,https://docs.databricks.com/administration-guide/users-groups/users.html,https://docs.databricks.com/administration-guide/users-groups/users.html
28,INFO-7,Informational,VPC Peering,-1,Medium,VPC endpoints or Private Link are recommended,1,0,0,1,0,Manual check,Manual check,https://docs.aws.amazon.com/vpc/latest/privatelink/create-interface-endpoint.html,https://docs.aws.amazon.com/vpc/latest/privatelink/create-interface-endpoint.html,https://docs.aws.amazon.com/vpc/latest/privatelink/create-interface-endpoint.html
29,INFO-8,Informational,Job View Acls,-1,High,Use Job Visibility Control to prevent users from viewing jobs where they do not have permissions,1,0,0,1,0,Check workspace-conf for enableJobViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableJobViewAcls',https://docs.databricks.com/administration-guide/access-control/jobs-acl.html,https://docs.databricks.com/administration-guide/access-control/jobs-acl.html,https://docs.databricks.com/administration-guide/access-control/jobs-acl.html
30,INFO-9,Informational,Cluster View Acls,-1,High,Use Cluster Visibility Control to prevent users from viewing clusters where they do not have permissions,1,0,0,1,0,Check workspace-conf for enforceClusterViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enforceClusterViewAcls',https://docs.databricks.com/security/access-control/cluster-acl.html,https://docs.databricks.com/security/access-control/cluster-acl.html,https://docs.databricks.com/security/access-control/cluster-acl.html
31,INFO-10,Informational,Workspace View Acls,-1,High,Use Workspace Visibility Control to prevent users from viewing notebooks and other objects where they do not have permissions in the workspace,1,0,0,1,0,Check workspace-conf for enforceWorkspaceViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enforceWorkspaceViewAcls',https://docs.databricks.com/security/access-control/workspace-acl.html,https://docs.databricks.com/security/access-control/workspace-acl.html,https://docs.databricks.com/security/access-control/workspace-acl.html
32,INFO-11,Informational,Project Type In Workspace,-1,High,It is recommended to store code in Git repos,1,0,0,1,0,Check workspace-conf for enableProjectTypeInWorkspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableProjectTypeInWorkspace',https://docs.databricks.com/repos/index.html,https://docs.databricks.com/repos/index.html,https://docs.databricks.com/repos/index.html
33,NS-1,Network Security,All Purpose Cluster Public Keys,-1,High,"Remote SSH access to clusters is discouraged, use web terminal instead",1,0,0,1,0,Check if ssh_public_keys is configured on any cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/web-terminal.html,https://docs.databricks.com/clusters/web-terminal.html,https://docs.databricks.com/clusters/web-terminal.html
34,NS-2,Network Security,Job Cluster Public Keys,-1,High,"Remote SSH access to clusters is discouraged, use web terminal instead",1,0,0,1,0,Check if ssh_public_keys is configured on any job cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/clusters/web-terminal.html,https://docs.databricks.com/clusters/web-terminal.html,https://docs.databricks.com/clusters/web-terminal.html
35,NS-3,Network Security,Private Link,-1,High,Configure private network connectivity,1,0,0,1,0,Check if private_access_settings_id is set for the workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/administration-guide/cloud-configurations/aws/privatelink.html,https://docs.databricks.com/administration-guide/cloud-configurations/aws/privatelink.html,https://docs.databricks.com/administration-guide/cloud-configurations/aws/privatelink.html
36,NS-4,Network Security,BYOVPC,-1,Medium,Deploy with a customer-managed VPC to allow implementation of data exfiltration protections and VPC endpoints,1,0,0,1,0,Check if network_id is set for this workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/administration-guide/cloud-configurations/aws/customer-managed-vpc.html,https://docs.databricks.com/administration-guide/cloud-configurations/aws/customer-managed-vpc.html,https://docs.databricks.com/administration-guide/cloud-configurations/aws/customer-managed-vpc.html
37,NS-5,Network Security,IP Access List,-1,Medium,Configure IP access lists that restrict the IP addresses that can authenticate to Databricks to protect against data exfiltration and account takeover,1,0,0,1,0,Check if ip-access-lists are configured and enabled,curl --netrc -X GET \ https://<workspace_url>/api/2.0/ip-access-lists,https://docs.databricks.com/security/network/ip-access-list.html#add-an-ip-access-list,https://docs.databricks.com/security/network/ip-access-list.html#add-an-ip-access-list,https://docs.databricks.com/security/network/ip-access-list.html#add-an-ip-access-list